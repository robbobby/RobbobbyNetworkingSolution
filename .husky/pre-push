#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🚀 Running pre-push validation..."

# Run integration tests (skip if no tests available)
echo "🔗 Running integration tests..."
if dotnet test --filter Category=Integration --verbosity minimal 2>/dev/null; then
    echo "✅ Integration tests completed successfully!"
else
    echo "⚠️  No integration tests found - continuing with validation"
fi

# Run performance benchmarks (skip if no tests available)
echo "⚡ Running performance benchmarks..."
if dotnet test --filter Category=Benchmark --verbosity minimal 2>/dev/null; then
    echo "✅ Benchmark tests completed successfully!"
else
    echo "⚠️  No benchmark tests found - continuing with validation"
fi

echo "🔨 Building solution in Release mode..."
dotnet build --configuration Release

echo "📦 Validating package builds..."
dotnet pack --configuration Release --no-build --verbosity minimal

echo "✅ Pre-push validation completed successfully!"
